//Test standard import statement

//FAIL: Not yet imported
fuzzy_join::cleanTitle;##
FAILURE


import fuzzy_join;
//Test imported JavaUDF
fuzzy_join::cleanTitle("XY");##
"XY"

//Test imported JaqlFunction
fuzzy_join::$normalize([{a:"a"},{a:"XY"}],"a");##
[
  {
    "a": "A"
  },
  {
    "a": "XY"
  }
]

//FAIL: Only namespace got imported, not functions
cleanTitle(##
FAILURE
"AB");
$normalize(##
FAILURE
[{a:"a"},{a:"XY"}],"a");

//Test module directory detection
//Has no namespace file and no scripts directory
import fail_not_detected;##
FAILURE

//Exports variables that do not exist
import fail_wrong_exports;##
FAILURE

import fail_invalid_namespace_file;##
FAILURE


//Test import all statement
import scripts_and_udf (*);
roundUp(0.1);##
1

qgram("ab");##
[
  [
    "§§a",
    1
  ],
  [
    "§ab",
    1
  ],
  [
    "ab§",
    1
  ],
  [
    "b§§",
    1
  ]
]

pi;##
3


//Test import namespace + functions statement
import scripts_only (three,four);
three;##
2

four;##
3

//FAIL: not imported
five;##
FAILURE

//Should work
scripts_only::five;##
5



//Test meta modules (reexport variables from other modules)
import meta;
meta::cleanTitle("ab");##
"AB"

meta::$normalize([{a:"a"},{a:"XY"}],"a");##
[
  {
    "a": "A"
  },
  {
    "a": "XY"
  }
]


//Test scope & shadowing
import scripts_with_namespace(*);
x;##
23

y;##
46

::x;##
FAILURE
 //FAIL: doesn't exist
x=1;##
"x"

x;##
1

::x;##
1

scripts_with_namespace::x;##
23


//Test exports
//FAIL: It is not exported
fuzzy_join::qgram;##
FAILURE
 
//FAIL: scripts_with_namespaces has this should not be imported
z;##
FAILURE


//Test export lists
listExports("fuzzy_join");##
[
  "$fuzzy_join",
  "$normalize",
  "cleanTitle"
]

listExports("meta");##
[
  "$fuzzy_join",
  "$normalize",
  "cleanTitle"
]

listExports("scripts_and_udf");##
[
  "qgram",
  "jaccard",
  "cleanTitle",
  "roundUp",
  "memHashMap",
  "nullToZero",
  "pi"
]

listExports("scripts_only");##
[
  "five",
  "three",
  "four"
]


//Test reassigning values
meta::cleanTitle = ##
FAILURE
2;


//Test examples function
examples("module_foo");##
null
